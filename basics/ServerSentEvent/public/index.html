<!DOCTYPE html>
<html>
<head>
  <title>SSE Example</title>
</head>
<body>
  <h1>Server-Sent Events</h1>
  <ul id="events"></ul>
  <button id="stop">stop strewing</button>

  <script>
    const eventSource = new EventSource('http://localhost:3000/events');
    const eventsList = document.getElementById('events');

    eventSource.onmessage = (event) => {
      const data = JSON.parse(event.data);
      const li = document.createElement('li');
      li.textContent = `response: ${data.count}`;
      eventsList.appendChild(li);
    };

    eventSource.onerror = (err) => {
      console.error('EventSource failed:', err);
      eventSource.close();
    };

    const stopButton = document.getElementById('stop');
    stopButton.addEventListener('click', () => {
      eventSource.close();
    });
  </script>
</body>
</html>
